https://coursehunter.net/course/devsecops-bootcamp?lesson=48
# 1. IAM Resources

**IAM Resources** – это компоненты, которые AWS IAM (Identity and Access Management) для управления доступом к вашим AWS ресурсам. Основные ресурсы IAM включают:

- **IAM Users**: Учетные записи для индивидуальных пользователей, которые требуют доступа к AWS.
- **IAM Groups**: Группы пользователей для упрощенного управления доступом. Политики могут быть назначены группе, а все пользователи в группе получат эти права.
- **IAM Roles**: Учетные записи, которые могут быть назначены AWS сервисам или другим пользователям для определенных сроков. В отличие от пользователей, роли не имеют постоянных учетных данных.
- **IAM Policies**: Наборы правил, которые определяют разрешенные или запрещенные действия на AWS ресурсах. Политики могут быть прикреплены к пользователям, группам или ролям.
- **IAM Identity Providers**: Позволяют устанавливать доверительные отношения с внешними идентификационными провайдерами, такими как Google или Facebook, для обеспечения доступа к AWS ресурсам с помощью внешних учетных записей.

IAM предоставляет возможность детально контролировать доступ к ресурсам AWS и управлять правами доступа в соответствии с политиками безопасности вашей организации.

---

# 2. Создание нового администратора и предоставление прав для Secure Access из GitLab CI/CD Pipeline

Для безопасного доступа из GitLab CI/CD pipeline к AWS необходимо создать IAM пользователя с администраторскими правами и ограничениями, чтобы минимизировать потенциальные риски.

### Шаги по созданию нового администратора и предоставлению прав

#### Шаг 1: Вход в AWS Management Console

1. Перейдите в [AWS Management Console](https://aws.amazon.com/console/).
2. Введите свои учетные данные для входа.

#### Шаг 2: Создание IAM пользователя

1. Выполните поиск по сервисам и выберите **IAM**.
2. Перейдите в раздел **Users** и нажмите на кнопку **Add user**.
3. Введите имя для нового пользователя, например, `gitlab-admin-user`.
4. Выберите тип доступа:
   - **Programmatic access**: Позволяет получать доступ к AWS через API, CLI и SDK (необходим для GitLab CI/CD).
   - **AWS Management Console access**: Позволяет пользователю входить в веб-интерфейс консоли (опционально).

5. Нажмите **Next: Permissions**.

#### Шаг 3: Предоставление прав пользователю

1. На странице **Set permissions** вы можете выбрать один из следующих способов назначения прав:
   - **Attach existing policies directly**: Здесь вы можете выбрать готовую политику, например, `AdministratorAccess`, которая предоставляет полный доступ ко всем ресурсам.
   - **Add user to group**: Если у вас есть группа с нужными правами доступа, вы можете добавить пользователя в эту группу.
   - **Copy permissions from existing user**: Дублируйте права другого пользователя.
   - **Attach policies directly**: Создайте свою собственную политику с конкретными разрешениями (например, разрешение на доступ только к определенным ресурсам).

2. Рекомендуется использовать **Attach existing policies directly** и выбрать `AdministratorAccess`, так как это облегчит управление доступом на начальном этапе.

3. Нажмите **Next: Tags**, если хотите добавить теги (это опционально).

4. Нажмите **Next: Review** для подтверждения созданных настроек.

5. Нажмите **Create user**.

#### Шаг 4: Получение учетных данных

1. После создания пользователя вы увидите его **Access Key ID** и **Secret Access Key**. Скопируйте эти данные и храните их в безопасном месте, так как они будут использоваться для доступа из GitLab CI/CD.

#### Шаг 5: Настройка GitLab CI/CD

1. Перейдите в настройки вашего репозитория в GitLab.
2. Перейдите на вкладку **Settings > CI / CD**.
3. В разделе **Variables** добавьте следующие переменные:
   - `AWS_ACCESS_KEY_ID`: значение Access Key ID из предыдущего шага.
   - `AWS_SECRET_ACCESS_KEY`: значение Secret Access Key из предыдущего шага.
   - `AWS_DEFAULT_REGION`: укажите регион, в котором находятся ваши ресурсы AWS, например, `us-east-1`.

4. Убедитесь, что `Protected` флажок отключен, если вы хотите использовать эти переменные в общедоступных пайплайнах.

### Рекомендуемые практики безопасности

- **Применение принципа наименьших привилегий**: Если вы не хотите предоставлять полные администраторские права, создайте пользовательские политики, которые ограничивают доступ только к необходимым ресурсам и действиям.
- **Регулярный мониторинг и аудит**: Используйте AWS CloudTrail для ведения всех API вызовов и доступа к ресурсам AWS. Регулярно проверяйте журналы для выявления несанкционированного доступа.
- **Использование временных учетных данных**: Для некоторых операций можно использовать временные роли вместо постоянных ключей доступа.
- **Многофакторная аутентификация (MFA)**: Включите MFA для повышения безопасности доступа.

---
